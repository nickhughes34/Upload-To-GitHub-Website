<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<style type="text/css">
html {pointer-events: none;}

    h4 
    {
        text-align: left;
    }

@media screen 
{

	.headerLineTitle
	{
		width:1.5in;
		display:inline-block;
		margin:0in;
		margin-bottom:.0001pt;
		font-size:11.0pt;
		font-family:"Calibri","sans-serif";
		font-weight:bold;
	}

	.headerLineText
	{
		display:inline;
		margin:0in;
		margin-bottom:.0001pt;
		font-size:11.0pt;
		font-family:"Calibri","sans-serif";
		font-weight:normal;
	}

   .pageHeader
   {
		font-size:14.0pt;
		font-family:"Calibri","sans-serif";
		font-weight:bold;
		visibility:hidden;
		display:none;
   }   
}

@media print 
{
	.headerLineTitle
	{
		width:1.5in;
		display:inline-block;
		margin:0in;
		margin-bottom:.0001pt;
		font-size:11.0pt;
		font-family:"Calibri","sans-serif";
		font-weight:bold;
	}

	.headerLineText
	{
		display:inline;
		margin:0in;
		margin-bottom:.0001pt;
		font-size:11.0pt;
		font-family:"Calibri","sans-serif";
		font-weight:normal;
	}

   .pageHeader
   {
		font-size:14.0pt;
		font-family:"Calibri","sans-serif";
		font-weight:bold;
		visibility:visible;
		display:block;
   }

}
</style>
</head>
<body>
<span class='headerLineTitle'>Subject:</span><span class='headerLineText'>(no subject)</span><br/><br/>
<font size="2"><div class="PlainText">Feedback from my posting[1] about FogBUGZ[2] Setup fell into four categories. <br>
<br>
*&quot;Why make Setup reversable? Instead you should collect all the information <br>
from the user and make all the changes in one batch at the end.&quot;* There are a <br>
couple of things to understand here. First of all, even if you do everything in <br>
one batch at the end, there's always a possibility that some step in the middle <br>
of the batch will fail, and in that case, a well-behaved setup program will <br>
back out the steps that were already done. There are well over 100 error <br>
messages in the string table for FogBUGZ Setup so the number of things that can <br>
fail is not insignificant. <br>
<br>
Second, it's not nice to tell people about an error in their input three pages <br>
after they made the mistake. For example, early in the FogBUGZ setup process we <br>
prompt you to create an account for FogBUGZ to use: <br>
<br>
[IMG: <a href="http://www.joelonsoftware.com/pictures/setupNewAcct.gif">http://www.joelonsoftware.com/pictures/setupNewAcct.gif</a> (FogBUGZ Setup <br>
Screenshot)] <br>
<br>
The account creation could fail for a myriad of reasons, none of which can be <br>
predicted before trying to create the account. For example, the password might <br>
not conform to the system password policy. And different national versions of <br>
Windows NT have different rules about accented letters in passwords (betcha <br>
didn't know that!). It's better to tell the user about this problem right away <br>
so they can correct their input rather than having a message come up during the <br>
long install process later, forcing the user to back up and fix it. And even if <br>
you force the user to back up and fix it, you still have to undo the first part <br>
of the work that you did before creating the account, otherwise you've left <br>
their system in an indeterminate state. <br>
<br>
In any case I need to write code to create the account and delete the account <br>
in case something later fails; I might as well call that code on this page of <br>
the wizard where I can display a useful error message. <br>
<br>
And what are the kinds of things that need to be reversable? Well, in order to <br>
upgrade FogBUGZ without requiring a reboot (and we _never, ever _require a <br>
reboot), we have to shut down a couple of processes that might have been <br>
keeping FogBUGZ files pinned down, such as IIS (Microsoft's web server). So <br>
part one of the batch is &quot;Stop IIS.&quot; Now if part 2 fails for some reason, it <br>
would be _extremely_ rude to leave IIS not running. And anyway, it's not like I <br>
don't need to write the code for &quot;Start IIS&quot; for the end of the batch. So the <br>
code to rollback &quot;Stop IIS&quot; is already written. No big deal, I just need to <br>
call it at the right place. <br>
<br>
I think one reason that people think you should &quot;gather all the info and then <br>
do all the work&quot; is because with very large installation programs that are very <br>
slow, this is a polite way to waste less of the user's time. Indeed even <br>
FogBUGZ setup does 95% of its work at the very end. But the &quot;create account&quot; <br>
operation is so fast, that principle simply doesn't apply here. Even our 95% of <br>
the work phase takes well under a minute, most of which is spent waiting for <br>
IIS to stop and start. <br>
<br>
*&quot;Why did you use VC&#43;&#43;/MFC? Surely an advanced intelligence such as yourself <br>
has admitted by now that Delphi[3] is more productive.&quot;* First of all, leave <br>
your language religious fanaticism at the Usenet door. Somehow I managed <br>
to figure out_ in high school_ that language advocacy and religious <br>
arguments are unbelievably boring.&nbsp; <br>
<br>
Secondly, even if Delphi were more productive, the only pertinent question, <br>
since I am writing the code, is _what is more productive for Joel Spolsky_. And <br>
I don't know Delphi at all, but I know Win32, MFC, and VC&#43;&#43; _really, really <br>
well_. So while I might not outcode a good Delphi programmer, I would <br>
definitely outcode a completely inexperienced Delphi programmer (which is me), <br>
certainly over a short 4 week project. Third, many of the things I needed to do <br>
in this setup program are things like &quot;grant the Logon as Service privilege to <br>
an account.&quot; This is rare enough that the only way to find out how to do this <br>
is to search the Microsoft knowlege base and the web in general. When you <br>
search the web in general for how to do fancy things with Windows NT, what you <br>
find is about 75% C code, maybe 20% VB code, and 5% everything else. Yes, I <br>
know, I could translate the C code into Delphi (assuming I was a sophisticated <br>
Delphi programmer, not a completely inexperienced Delphi programmer), but that <br>
costs as much productivity as I would supposedly gain from your supposedly more <br>
productive programming language. And fourth, I already had about 30% of the <br>
code I needed for Setup in MFC format: from FogBUGZ 2.0 Setup, and a library <br>
I've been using for years to make wizards. <br>
<br>
*&quot;Why make Setup at all? You already have your customers' money. Good Setup <br>
programs don't increase sales.&quot;* This was actually the smartest question and <br>
made me think the hardest. I came up with three reasons: <br>
<br>
- Decreased tech support cost. This setup program will pay for itself over the <br>
life of the code. <br>
- Delight my customers. When I'm trying to get them to upgrade to 4.0, I want <br>
them to remember how painless the 3.0 installation was, so they won't hesitate <br>
because they are afraid to upgrade. I'm still using an old version of <br>
SpamAssassin that is becoming increasingly ineffective, even though I know the <br>
new version is much better, because I just can't bear the thought of another <br>
morning wasted. The very memory of the first SpamAssassin installation -- all <br>
the little SSH windows, some su'ed, trying to scroll through man pages and <br>
Google Groups, accidentally hitting Ctrl&#43;Z in Emacs to undo and having it <br>
suspend, trying to guess why we can't get the MTA to run procmail, sorry it's <br>
too much. If SpamAssassin was making money off of upgraders they would have <br>
lost my business because they don't have a SETUP program. <br>
- Win reviews. Software reviewers always cast about for some kind of <br>
standardized way to rate software, even when they are comparing apples and <br>
oranges and planets and 17th century philosophers. They always have a <br>
meaningless list of things to review which can be applied to PC games, <br>
mainframe databases, web site auction software, and DNA sequencing <br>
software. And Setup is always on their list. A single flaw in setup is <br>
guaranteed to be mentioned in every review because every reviewer will see it <br>
and say &quot;Aha!&quot;<br>
<br>
<br>
*&quot;How can we make WISE[4] better?&quot; *Kudos to the product manager of WISE <br>
Installation System for calling me up and listening to my litany of all the <br>
reasons his product wasn't adequate for typical IIS/ASP/SQL applications.<br>
<br>
[1] <a href="http://www.joelonsoftware.com/news/20021002.html">http://www.joelonsoftware.com/news/20021002.html</a><br>
[2] <a href="http://www.fogcreek.com/FogBUGZ">http://www.fogcreek.com/FogBUGZ</a><br>
[3] <a href="http://discuss.fogcreek.com/delphiquestions">http://discuss.fogcreek.com/delphiquestions</a><br>
[4] <a href="http://www.wise.com">http://www.wise.com</a><br>
<br>
</div></font>
</body>
</html>
